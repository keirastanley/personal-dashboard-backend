    import query from "../db/index.js";
import artRouter from "../routes/art.js";

    //Ids for objects relating to Monet from the Met Museum
    const monetIds = [
    438003, 437133, 437135, 437127, 437125, 459107, 437124, 437106, 437122,
    437121, 438823, 438004, 437131, 438008, 438005, 438006, 437112, 437137,
    437109, 437105, 439173, 438007, 437108, 437111, 437130, 437110, 437119,
    437115, 437138, 437136, 437107, 436965, 437313, 438435, 437104, 437126,
    482969, 437118, 437129, 437120, 437117, 437123, 437128, 437113, 435882,
    671456, 438738, 389093, 669033, 337807, 436085, 459144, 722460, 271323,
    437317, 248068, 333817, 437300, 371202, 459110, 438551, 436785, 459139,
    494772, 489974, 435874, 461357, 436947, 19523, 11934, 437426, 11480, 436084,
    438136, 437315, 437685, 852668, 489687, 459121, 207484, 834263, 438815,
    437430, 436017, 437680, 436175, 437436, 11936, 437683, 460065, 438002, 484972,
    831088, 265904, 437686, 124185, 839041, 485705, 438098, 124336, 124337,
    124334, 270613, 262405, 262403, 262400, 262401, 262406, 263799, 263798,
    263796, 263797, 437432, 264019, 436090, 335611, 437301, 437309, 435984, 11032,
    12447, 460052, 10915, 437681, 262373, 435626, 436964, 855850, 742459, 855848,
    855849, 855852, 855851, 855853, 359319, 359321, 437989, 495585, 437310,
    766695, 766680, 766683, 766682, 766681, 766685, 766691, 766690, 766679,
    766684, 766678, 766689, 766677, 766688, 766693, 766676, 766687, 766675,
    766686, 766692, 766694, 766673, 766674, 485934, 341464, 828575, 36535, 437094,
    438816, 191202, 423180, 440729, 282074, 364880, 267602, 437307, 662132,
    384852, 436946, 486085, 37099, 156788, 435978, 436089, 437988, 435989, 437308,
    366762, 402150, 342496, 435961, 437311, 435875, 489988, 359320, 435988,
    435963, 435991, 289550, 436787, 267875, 676536, 438012, 57390, 271966, 437427,
    262431, 262434, 339721, 367715, 339000, 437097, 437433, 486736, 36539, 269329,
    267843, 388803, 375812, 262418, 262374, 262407, 437299, 435976, 438011,
    267571, 269284, 269300, 437160, 283107, 283137, 267529, 461152, 437853,
    498256, 435980, 437098, 436159, 439631, 486428, 435877, 488402, 282079,
    436819, 32363, 435872, 437312, 437429, 488978, 436960, 436173, 436944, 404547,
    201889, 436945, 435750, 435962, 269072, 435876, 435967, 435981, 437986,
    438819, 489700, 437424, 437684, 437437, 437514, 436120, 489633, 437658,
    435878, 436106, 485185, 437984, 436122, 438820, 488368, 436123, 437998,
    435880, 489766, 436144, 437159, 437847, 437891, 334373, 436524, 436080,
    435869, 437654, 436950, 337736, 439403, 438144, 484862, 436599, 437925,
    488227, 334174, 436548, 334652, 436951, 436948,
    ];

    const impressionismIdsUnfiltered = [
        13184,435877,10388,10391,436880,437430,437344,11858,459119,11557,11556,11105,441104,459240,438004,437990,437999,438002,438008,438011,438003,436024,438009,344210,437133,19322,493694,13177,437995,437988,436449,437984,657000,671456,437997,438014,13176,490147,492745,437996,437987,438551,437989,437994,438005,438000,435878,438007,437135,715022,492746,438006,437991,438017,486920,436157,490146,437993,436536,436155,436005,437125,437432,438013,438010,435874,202957,439382,339689,267685,13180,13183,440726,333817,437654,459738,459736,437436,436418,437657,436241,486270,334087,286070,669033,437127,438815,437122,437682,436085,438012,437121,438016,438015,839045,435869,435612,828575,459172,436126,436150,486162,437106,437998,345033,207804,283626,438018,435872,436525,437310,438001,436136,436534,459107,436923,436965,482132,283238,435626,437304,437309,437107,437428,364095,436886,436144,438816,437658,436964,436135,437110,436162,436089,437105,428563,437131,393917,399206,398884,399217,399438,399314,399200,306154,306155,437299,399219,399311,399205,386320,306151,306152,398882,399439,399220,261307,261487,306159,306163,306165,306166,306161,306156,306157,306153,306164,306162,306167,306160,306158,436293,435975,436785,437160,436002,399312,436091,437514,437306,437097,384831,270613,156567,766680,766683,766682,766681,766685,766691,766690,766679,766684,766678,766689,766677,766688,766693,766676,766687,766675,766686,766692,766695,766694,437305,437659,766673,766674,113218,437303,436004,437671,16868,364093,662132,459174,384852,436175,345245,399424,399426,399133,112529,106891,113238,113351,113207,119508,102722,113266,288741,269106,358730,633582,459993,399134,119645,119781,156782,122563,107563,123999,124436,98278,117428,108908,109221,168562,209640,169619,209666,209890,267602,437316,437685,437119,436121,339671,437313,436154,438658,436122,436123,459144,437435,661864,661606,661828,347426,437136,358829,157938,436132,437308,389680,337626,436140,343735,437112,358734,437655,438136,398874,158012,386316,351084,113045,113206,108839,209741,286839,286840,436173,437124,438823,437311,393444,648354,436141,438669,438950,439366,436139,436950,360090,367786,435884,436952,437980,459116,437094,437300,438817,436001,436960,436176,265707,112654,105024,238151,238150,289550,267875,489645,437512,437424,123220,107863,286113,84431,82460,437680,404160,436170,337089,439392,437138,358795,438132,435750,436945,436946,83176,285652,209520,282079,339649,435870,437425,435654,435880,436529,435621,437130,437384,210682,112762,159220,81730,269329,267843,348516,271965,437111,436172,436953,436159,358801,435653,22056,459110,439360,359364,336327,358786,437108,438655,438670,436023,436528,436535,436970,83257,688872,688791,159187,267571,437381,269284,269300,435883,437069,436127,435885,492868,436128,439358,436008,436003,436016,436014,437109,437835,439361,439398,437148,404888,339757,438820,436944,267529,436866,436143,436138,436156,438821,334703,399218,377395,377381,365011,376475,377379,438818,341755,376474,261480,436125,436153,333813,339751,488319,436000,436678,495297,339752,436951,337864,437123,364094,436174,339760,364337,438144,480553,435967,436533,782304,437585,436957,438819,435868,359363,359365,493791,334473,437833,484803,435965,435991,436115,436446,436145,437315,437429,437836,437434,438814,435963,436149,436961,333815,437427,436947,437438,435873,436530,435702,436954,333884,334125,337177,439368,286390,286628,337531,337536,334468,358715,435981,436022,436018,436095,435988,436524,334737,337828,337825,337881,348513,437115,436958,437392,436093,437437,334174,484860,437852,437129,459173,435871,359361,334344,488475,437117,334189,334379,334429,435739,334414,337797,436063,337852,436570,436124,437175,436792,337789,440407,496203,375840,436575,435867,334652,438435,488505,437672,436948,337784,436076,436928,337279,339674,337622,341824,337827,336789,436573,489498,488368,437301,436120,337796,435751,435802,437118,437388,489994,488978,436142,440332,435875,489223,489643,437104,333943,435968,437079,436019,436011,437868,334312,437843,470304,436840,439355,440331,437942,333944,489559,334345,436198,333814,437343,437640,435849,436949,436956,436166,437093,436962,436548,436188,437896,435905,436040,437052,436618,437128,436027,436114,436619,437890,500421,483301,435881,436028,482491,488477,437386,437827,436026,437331,437409,437410,436553,435597
    ]

    const impressionismIds = impressionismIdsUnfiltered.filter(el => monetIds.includes(el) === false);

    export async function getArt() {
    // const randomNumber = Math.floor(Math.random() * monetIds.length)
    // console.log(randomNumber)
    // const id = monetIds[randomNumber]
    // console.log(id)
    // const result = await fetch(
    //     `https://collectionapi.metmuseum.org/public/collection/v1/objects/${id}`
    // );
    // const data = await result.json();
    // return data;

    const items = [];
    for (let i = 0; i < monetIds.length; i++) {
        const result = await fetch(
            `https://collectionapi.metmuseum.org/public/collection/v1/objects/${monetIds[i]}`
        );
        const data = await result.json();
        console.log(data)
        if (data.message || data.constituents === null){
            i++;
        }
        else {
            const itemObj = {
                title: data.title,
                artist: data.constituents[0].name,
                medium: data.medium,
                year: data.objectDate,
                src: data.primaryImage,
                alt: data.title,
                tags: data.tags,
            };
            items.push(itemObj)
        }
    }
    return items;
    }

export async function getItemsFromGallery(){
    const result = await query('SELECT * FROM art;');
    return result.rows;
}

export async function addNewItem() {
    const items = [];
    for (let i = 0; i < impressionismIds.length; i++) {
        const result = await fetch(
            `https://collectionapi.metmuseum.org/public/collection/v1/objects/${impressionismIds[i]}`
        );
        const data = await result.json();
        console.log(data)
        if (data.message || data.constituents === null || data.primaryImage === null){
            i++;
        }
        else {
            await query(
                "INSERT INTO art(title, artist, medium, year, src, alt, tags) VALUES ($1, $2, $3, $4, $5, $6, $7);",
                [
                data.title,
                data.constituents[0].name,
                data.medium,
                data.objectDate,
                data.primaryImage,
                data.title,
                data.tags,
                ]
            );  
        }
    }
    return items;
}

//CLEAR AWAY ENTRIES WITHOUT A VALID IMAGE 
export async function deleteItem(){
    const result = await fetch('http://localhost:3000/api/art');
    const items = result.json();
    for (let i = 0; i < items.length; i++){
        if (items.src === ""){
            await query(
            "DELETE FROM art WHERE id = $1;",
            [
            items.id
            ]
            );  
        }
    }
}
//ADDED RESULTS FOR SEARCH "MONET" TO DATABASE

// export async function addNewItem() {
//     const items = [];
//     for (let i = 0; i < monetIds.length; i++) {
//         const result = await fetch(
//             `https://collectionapi.metmuseum.org/public/collection/v1/objects/${monetIds[i]}`
//         );
//         const data = await result.json();
//         console.log(data)
//         if (data.message || data.constituents === null){
//             i++;
//         }
//         else {
//             await query(
//                 "INSERT INTO art(title, artist, medium, year, src, alt, tags) VALUES ($1, $2, $3, $4, $5, $6, $7);",
//                 [
//                 data.title,
//                 data.constituents[0].name,
//                 data.medium,
//                 data.objectDate,
//                 data.primaryImage,
//                 data.title,
//                 data.tags,
//                 ]
//             );  
//         }
//     }
//     return items;
// }
